{
  "Diagnostics": {
    "Startup": {
      "EnableVerboseLogging": true,
      "EnableBreakpointDebugging": true,
      "EnablePhaseIsolation": false,
      "EnableRuntimeProfiler": false,
      "EnableContainerDiagnostics": true,
      "EnableExceptionDiagnostics": true,
      "LogStackTraces": true,
      "LogAssemblyLoading": true,
      "LogMemoryUsage": true,
      "_comment": "Set EnablePhaseIsolation to true to comment out specific phases during debugging"
    },
    "Runtime": {
      "EnableDotnetTrace": false,
      "TraceProviders": [
        "Microsoft-DotNETCore-SampleProfiler",
        "Microsoft-Windows-DotNETRuntime"
      ]
    }
  },
  "ConnectionStrings": {
    "Default": "Server=.\\SQLEXPRESS;Database=WileyWidgetDev;Trusted_Connection=True;TrustServerCertificate=True;",
    "DefaultConnection": "Server=.\\SQLEXPRESS;Database=WileyWidgetDev;Trusted_Connection=True;TrustServerCertificate=True;"
  },
  "DB": {
    "AutoMigrate": false,
    "_comment": "Set to false in production to prevent automatic database migrations"
  },
  "Serilog": {
    "Using": [
      "Serilog.Sinks.File",
      "Serilog.Sinks.Console",
      "Serilog.Sinks.Async",
      "Serilog.Enrichers.Environment",
      "Serilog.Enrichers.Process",
      "Serilog.Enrichers.Thread"
    ],
    "MinimumLevel": {
      "Default": "Verbose",
      "Override": {
        "Microsoft": "Verbose",
        "System": "Verbose",
        "WileyWidget": "Verbose",
        "WileyWidget.Startup": "Verbose",
        "WileyWidget.DI": "Verbose",
        "WileyWidget.Exception": "Verbose"
      }
    },
    "Enrich": [
      "FromLogContext",
      "WithMachineName",
      "WithProcessId",
      "WithThreadId",
      "WithEnvironmentName"
    ],
    "WriteTo": [
      {
        "Name": "Console",
        "Args": {
          "outputTemplate": "{Timestamp:HH:mm:ss} [{Level:u3}] {SourceContext} {Message:lj}{NewLine}{Exception}"
        }
      },
      {
        "Name": "Async",
        "Args": {
          "configure": [
            {
              "Name": "File",
              "Args": {
                "path": "logs/startup-.txt",
                "rollingInterval": "Day",
                "retainedFileCountLimit": 7,
                "fileSizeLimitBytes": 52428800,
                "rollOnFileSizeLimit": true,
                "shared": true,
                "outputTemplate": "{Timestamp:yyyy-MM-dd HH:mm:ss.fff zzz} [{Level:u3}] {MachineName} {ProcessId}:{ThreadId} {SourceContext} {CorrelationId} {Message:lj}{NewLine}{Exception}"
              }
            }
          ]
        }
      },
      {
        "Name": "Async",
        "Args": {
          "configure": [
            {
              "Name": "File",
              "Args": {
                "path": "logs/wiley-widget-.log",
                "rollingInterval": "Day",
                "retainedFileCountLimit": 30,
                "fileSizeLimitBytes": 104857600,
                "rollOnFileSizeLimit": true,
                "shared": true,
                "outputTemplate": "{Timestamp:yyyy-MM-dd HH:mm:ss.fff zzz} [{Level:u3}] {MachineName} {ProcessId}:{ThreadId} {SourceContext} {CorrelationId} {Message:lj}{NewLine}{Exception}"
              }
            }
          ]
        }
      },
      {
        "Name": "Async",
        "Args": {
          "configure": [
            {
              "Name": "File",
              "Args": {
                "path": "logs/errors-.log",
                "rollingInterval": "Day",
                "retainedFileCountLimit": 90,
                "restrictedToMinimumLevel": "Warning",
                "outputTemplate": "{Timestamp:yyyy-MM-dd HH:mm:ss.fff zzz} [{Level:u3}] {MachineName} {ProcessId}:{ThreadId} {SourceContext} {CorrelationId} {Message:lj}{NewLine}{Exception}"
              }
            }
          ]
        }
      }
    ]
  },
  "Serilog:Production": {
    "MinimumLevel": {
      "Default": "Information",
      "Override": {
        "Microsoft": "Warning",
        "System": "Warning",
        "WileyWidget": "Information",
        "WileyWidget.Security": "Debug",
        "WileyWidget.Services.QuickBooksService": "Information"
      }
    },
    "WriteTo": [
      {
        "Name": "Async",
        "Args": {
          "configure": [
            {
              "Name": "File",
              "Args": {
                "path": "logs/production/wiley-widget-.log",
                "rollingInterval": "Day",
                "retainedFileCountLimit": 90,
                "fileSizeLimitBytes": 52428800,
                "rollOnFileSizeLimit": true,
                "shared": true,
                "outputTemplate": "{Timestamp:yyyy-MM-dd HH:mm:ss.fff zzz} [{Level:u3}] {MachineName} {ProcessId}:{ThreadId} {SourceContext} {CorrelationId} {Message:lj}{NewLine}{Exception}"
              }
            }
          ]
        }
      },
      {
        "Name": "Async",
        "Args": {
          "configure": [
            {
              "Name": "File",
              "Args": {
                "path": "logs/production/errors-.log",
                "rollingInterval": "Day",
                "retainedFileCountLimit": 365,
                "restrictedToMinimumLevel": "Warning",
                "outputTemplate": "{Timestamp:yyyy-MM-dd HH:mm:ss.fff zzz} [{Level:u3}] {MachineName} {ProcessId}:{ThreadId} {SourceContext} {CorrelationId} {Message:lj}{NewLine}{Exception}"
              }
            }
          ]
        }
      },
      {
        "Name": "Async",
        "Args": {
          "configure": [
            {
              "Name": "File",
              "Args": {
                "path": "logs/production/security-.log",
                "rollingInterval": "Day",
                "retainedFileCountLimit": 365,
                "restrictedToMinimumLevel": "Information",
                "outputTemplate": "{Timestamp:yyyy-MM-dd HH:mm:ss.fff zzz} [{Level:u3}] {MachineName} {ProcessId}:{ThreadId} {SourceContext} {CorrelationId} {Message:lj}{NewLine}{Exception}"
              }
            }
          ]
        }
      }
    ]
  },
  "Database": {
    "Provider": "SqlServer",
    "EnableSensitiveDataLogging": false,
    "EnableDetailedErrors": true,
    "CommandTimeoutSeconds": 30,
    "MaxRetryCount": 3,
    "MaxRetryDelaySeconds": 10,
    "AutoMigrate": false,
    "BackupOnStartup": false,
    "BackupDirectory": "",
    "BackupRetentionDays": 90,
    "BackupCommandTimeoutSeconds": 900,
    "_comment": "BackupOnStartup and BackupDirectory for pre-migration safety. Set BackupOnStartup to true and provide BackupDirectory path to enable."
  },
  "Security": {
    "SecretsInitializationTimeoutSeconds": 30,
    "RequireVaultIntegrityCheck": false,
    "EnableSecurityAuditLogging": true,
    "CriticalSecretsRequired": ["QBO-CLIENT-ID", "QBO-CLIENT-SECRET"]
  },
  "Security:Production": {
    "SecretsInitializationTimeoutSeconds": 30,
    "RequireVaultIntegrityCheck": true,
    "EnableSecurityAuditLogging": true,
    "EnableEncryptionValidation": true,
    "RequireStrongEncryption": true,
    "MinimumTlsVersion": "1.2",
    "CriticalSecretsRequired": [
      "QBO-CLIENT-ID",
      "QBO-CLIENT-SECRET",
      "QBO-REALM-ID",
      "APPLICATIONINSIGHTS_CONNECTION_STRING"
    ]
  },
  "HealthChecks": {
    "DefaultTimeout": "00:00:45",
    "DatabaseTimeout": "00:00:30",
    "ExternalServiceTimeout": "00:00:20",
    "MaxRetries": 3,
    "RetryDelay": "00:00:2",
    "CircuitBreakerThreshold": 5,
    "CircuitBreakerTimeout": "00:05:00",
    "ContinueOnFailure": true,
    "SkipServices": []
  },
  "EnableQuickBooks": false,
  "QuickBooks": {
    "ClientId": "${QBO_CLIENT_ID}",
    "ClientSecret": "${QBO_CLIENT_SECRET}",
    "RedirectUri": "${QBO_REDIRECT_URI}",
    "Environment": "${QBO_ENVIRONMENT}"
  },
  "Grok": {
    "ApiKey": "${XAI_API_KEY}",
    "Endpoint": "https://api.x.ai/v1",
    "Model": "grok-4"
  },
  "XAI": {
    "Enabled": true,
    "ApiKey": "${XAI_API_KEY}",
    "Endpoint": "https://api.x.ai/v1/chat/completions",
    "Model": "grok-4",
    "Temperature": 0.3,
    "MaxTokens": 800
  },
  "OpenAI": {
    "ApiKey": "${OPENAI_API_KEY}",
    "BaseUrl": "https://api.openai.com/v1/",
    "Model": "gpt-4"
  },
  "App": {
    "BudgetVarianceHighThresholdPercent": 15,
    "BudgetVarianceLowThresholdPercent": 5,
    "AIHighConfidence": 85,
    "AILowConfidence": 60,
    "EnterpriseDataCacheSeconds": 30
  },
  "System.Diagnostics": {
    "Sources": [
      {
        "Name": "System.Windows.Markup",
        "SwitchValue": "Error",
        "Listeners": [
          {
            "Name": "textListener"
          }
        ]
      }
    ],
    "Trace": {
      "AutoFlush": true
    }
  },
  "AppSettings": {
    "EnableFontCaching": true,
    "SyncfusionEnableOptimization": true,
    "DisableProcessorFeatures": false
  },
  "ApplicationInsights": {
    "InstrumentationKey": "${APPLICATIONINSIGHTS_INSTRUMENTATIONKEY}",
    "ConnectionString": "${APPLICATIONINSIGHTS_CONNECTION_STRING}",
    "EnableAdaptiveSampling": true,
    "EnablePerformanceCounterCollectionModule": true,
    "EnableDependencyTrackingTelemetryModule": true,
    "EnableAzureInstanceMetadataTelemetryModule": true,
    "EnableAppServicesHeartbeatTelemetryModule": true,
    "EnableEventCounterCollectionModule": true,
    "EnableSqlCommandTextInstrumentation": false,
    "EnableHttpTriggerTelemetry": true
  },
  "Modules": {
    "_comment": "Only active modules after Phase 0 cleanup (2025-11-09)",
    "Order": ["CoreModule"],
    "Regions": {
      "CoreModule": ["MainRegion", "SettingsRegion"],
      "QuickBooksModule": ["MainRegion", "QuickBooksRegion"]
    }
  },
  "SigNoz": {
    "Endpoint": "http://localhost:4317",
    "Environment": "development",
    "ServiceName": "wiley-widget",
    "ServiceVersion": "1.0.0",
    "EnableTracing": true,
    "EnableMetrics": true,
    "EnableLogging": true,
    "SampleRatio": 1.0,
    "_comment": "Self-hosted SigNoz configuration. For SigNoz Cloud, update Endpoint to https://ingest.{region}.signoz.cloud:443 and add Headers with signoz-ingestion-key"
  },
  "Startup": {
    "SecretsTimeoutSeconds": 30,
    "BriefAwaitTimeoutSeconds": 5,
    "MaxResolveRetries": 3
  }
}

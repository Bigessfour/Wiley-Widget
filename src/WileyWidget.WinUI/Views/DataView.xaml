<Page
    x:Class="WileyWidget.WinUI.Views.DataView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:controls="using:CommunityToolkit.WinUI.UI.Controls"
    mc:Ignorable="d"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <TextBlock Grid.Row="0" 
                   Text="Data Explorer" 
                   Style="{ThemeResource TitleTextBlockStyle}" 
                   Margin="24,24,24,12" />

        <Grid Grid.Row="1" Margin="24,0,24,12">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <TextBox x:Name="SearchBox"
                     Grid.Column="0"
                     PlaceholderText="Search data..."
                     Text="{x:Bind ViewModel.SearchQuery, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                     AutomationProperties.Name="Search Data Input" />

            <Button Grid.Column="1" 
                    Content="Refresh"
                    Margin="12,0,0,0"
                    Command="{x:Bind ViewModel.RefreshCommand}"
                    AutomationProperties.Name="Refresh Data Button" />
        </Grid>

        <controls:DataGrid x:Name="DataGridView"
                          Grid.Row="2"
                          ItemsSource="{x:Bind ViewModel.DataItems, Mode=OneWay}"
                          AutoGenerateColumns="False"
                          IsReadOnly="True"
                          GridLinesVisibility="All"
                          AlternatingRowBackground="{ThemeResource SystemControlBackgroundListLowBrush}"
                          CanUserReorderColumns="True"
                          CanUserResizeColumns="True"
                          CanUserSortColumns="True"
                          Margin="24,0,24,24"
                          AutomationProperties.Name="Data Grid">
            
            <controls:DataGrid.Columns>
                <controls:DataGridTextColumn Header="ID" 
                                            Binding="{Binding Id}" 
                                            Width="100" />
                <controls:DataGridTextColumn Header="Name" 
                                            Binding="{Binding Name}" 
                                            Width="*" />
                <controls:DataGridTextColumn Header="Category" 
                                            Binding="{Binding Category}" 
                                            Width="150" />
                <controls:DataGridTextColumn Header="Amount" 
                                            Binding="{Binding Amount, StringFormat='{}{0:C}'}" 
                                            Width="120" />
                <controls:DataGridTextColumn Header="Date" 
                                            Binding="{Binding Date, StringFormat='{}{0:d}'}" 
                                            Width="120" />
            </controls:DataGrid.Columns>
        </controls:DataGrid>

        <ProgressRing Grid.Row="2"
                      IsActive="{x:Bind ViewModel.IsLoading, Mode=OneWay}"
                      Width="50"
                      Height="50"
                      HorizontalAlignment="Center"
                      VerticalAlignment="Center" />
    </Grid>
</Page>

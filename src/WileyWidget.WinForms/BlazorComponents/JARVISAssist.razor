@namespace WileyWidget.WinForms.BlazorComponents
@using Microsoft.JSInterop
@inject IJSRuntime JS

<div style="background-color: darkblue !important; color: #fff; height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; border: 20px solid lime !important; box-sizing: border-box;">
    <h1 style="color: lime; font-size: 50px; margin: 0;">BLAZOR LIVES (V4)</h1>
    <p style="font-size: 24px;">IF YOU SEE THIS DARK BLUE SCREEN WITH LIME BORDER, BLAZOR IS RENDERING!</p>
    <p>Rendered at: @DateTime.Now.ToString("HH:mm:ss.fff")</p>
    <div id="js-test" style="margin-top: 20px; padding: 20px; background: #333; border: 2px solid white; border-radius: 10px;">
        JS Interop Status: <span id="js-result" style="font-weight: bold; color: yellow;">Initializing JSRuntime...</span>
    </div>
</div>

@code {
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            try {
                await Task.Delay(500); // Brief delay to ensure DOM is ready
                await JS.InvokeVoidAsync("eval", @"
                    console.log('[JARVIS-BLAZOR] JS Interop Test Starting');
                    const el = document.getElementById('js-result');
                    if (el) {
                        el.innerText = 'SUCCESS (' + window.innerWidth + 'x' + window.innerHeight + ')';
                        el.style.color = '#0f0';
                        document.title = 'JARVIS - BLAZOR ACTIVE';
                    }
                ");
            } catch (Exception ex) {
                Console.WriteLine("JS Error: " + ex.Message);
            }
        }
    }
}

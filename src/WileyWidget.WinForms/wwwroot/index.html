<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Wiley Widget</title>
    <base href="./" />
    <!-- Syncfusion Blazor Themes - Change to a theme compatible with Office2019Colorful, e.g., office365 or bootstrap5 -->
    <link href="_content/Syncfusion.Blazor.Themes/office365.css" rel="stylesheet" />
    <!-- Or bootstrap5.css if office365 not available in v32.1.19 -->
    <!-- Custom AssistView styling -->
    <link href="css/ai-assist.css" rel="stylesheet" />
    <!-- Add a custom JS file for error handling if needed -->
    <style>
      html,
      body,
      #app,
      .blazor-container {
        height: 100%;
        margin: 0;
        padding: 0;
        overflow: hidden;
      }
    </style>
  </head>
  <body style="height: 100%; margin: 0; overflow: hidden">
    <div id="app">Loading...</div>

    <div id="blazor-error-ui">
      An unhandled error has occurred.
      <a href="" class="reload">Reload</a>
      <a class="dismiss">ðŸ—™</a>
    </div>

    <script src="_framework/blazor.webview.js"></script>
    <!-- Syncfusion Blazor Script - MUST load AFTER blazor.webview.js -->
    <script src="_content/Syncfusion.Blazor.Core/scripts/syncfusion-blazor.min.js"></script>
    <!-- Register Syncfusion Blazor License (before Blazor bootstrap completes) -->
    <script>
      console.log("Blazor host page loaded - checking Syncfusion license..."); // NEW: Debug log
      if (window.SyncfusionBlazor) {
        // License key is injected from C# environment variable via window.syncfusionLicenseKey
        var licenseKey = window.syncfusionLicenseKey || "";
        if (licenseKey) {
          window.SyncfusionBlazor.RegisterSyncfusionLicense(licenseKey);
          console.log("Syncfusion Blazor license registered successfully"); // Debug: Confirm in dev tools console
        } else {
          console.warn(
            "[JARVIS-LICENSE] No Syncfusion license key available. Blazor components may render with trial watermarks."
          );
        }
      } else {
        console.error("SyncfusionBlazor not found - ensure AddSyncfusionBlazor() in DI");
      }
      window.addEventListener("error", (e) => console.error("Blazor Error:", e.message)); // NEW: Catch global JS errors
    </script>
  </body>
</html>

{
  "ConnectionStrings": {
    "DefaultConnection": "Data Source=localhost\\SQLEXPRESS;Initial Catalog=WileyWidget;Integrated Security=True;Pooling=False;Encrypt=False;Trust Server Certificate=True"
  },
  "Serilog": {
    "Using": [
      "Serilog.Sinks.File",
      "Serilog.Sinks.Console",
      "Serilog.Sinks.Async",
      "Serilog.Enrichers.Environment",
      "Serilog.Enrichers.Process",
      "Serilog.Enrichers.Thread"
    ],
    "MinimumLevel": {
      "Default": "Verbose",
      "Override": {
        "Microsoft": "Verbose",
        "System": "Verbose",
        "WileyWidget": "Debug",
        "WileyWidget.Startup": "Verbose",
        "WileyWidget.DI": "Verbose",
        "WileyWidget.Exception": "Verbose"
      }
    },
    "Enrich": [
      "FromLogContext",
      "WithMachineName",
      "WithProcessId",
      "WithThreadId",
      "WithEnvironmentName"
    ],
    "WriteTo": [
      {
        "Name": "Console",
        "Args": {
          "outputTemplate": "{Timestamp:HH:mm:ss} [{Level:u3}] {SourceContext} {Message:lj}{NewLine}{Exception}"
        }
      },
      {
        "Name": "Async",
        "Args": {
          "bufferSize": 500,
          "configure": [
            {
              "Name": "File",
              "Args": {
                "path": "logs\\startup-.txt",
                "rollingInterval": "Day",
                "retainedFileCountLimit": 7,
                "fileSizeLimitBytes": 52428800,
                "rollOnFileSizeLimit": true,
                "shared": true,
                "outputTemplate": "{Timestamp:yyyy-MM-dd HH:mm:ss.fff zzz} [{Level:u3}] {MachineName} {ProcessId}:{ThreadId} {SourceContext} {CorrelationId} {Message:lj}{NewLine}{Exception}"
              }
            }
          ]
        }
      },
      {
        "Name": "Async",
        "Args": {
          "configure": [
            {
              "Name": "File",
              "Args": {
                "path": "C:\\Users\\biges\\Desktop\\Wiley-Widget\\logs\\wiley-widget-.log",
                "rollingInterval": "Day",
                "retainedFileCountLimit": 30,
                "fileSizeLimitBytes": 104857600,
                "rollOnFileSizeLimit": true,
                "shared": true,
                "outputTemplate": "{Timestamp:yyyy-MM-dd HH:mm:ss.fff zzz} [{Level:u3}] {MachineName} {ProcessId}:{ThreadId} {SourceContext} {CorrelationId} {Message:lj}{NewLine}{Exception}"
              }
            }
          ]
        }
      },
      {
        "Name": "Async",
        "Args": {
          "configure": [
            {
              "Name": "File",
              "Args": {
                "path": "logs\\errors-.log",
                "rollingInterval": "Day",
                "retainedFileCountLimit": 90,
                "shared": true,
                "restrictedToMinimumLevel": "Warning",
                "outputTemplate": "{Timestamp:yyyy-MM-dd HH:mm:ss.fff zzz} [{Level:u3}] {MachineName} {ProcessId}:{ThreadId} {SourceContext} {CorrelationId} {Message:lj}{NewLine}{Exception}"
              }
            }
          ]
        }
      }
    ]
  },
  "Logging": {
    "LogLevel": {
      "Default": "Trace",
      "Microsoft": "Trace",
      "Microsoft.Hosting.Lifetime": "Information",
      "Microsoft.EntityFrameworkCore": "Information",
      "Microsoft.EntityFrameworkCore.Database.Command": "Information",
      "Microsoft.EntityFrameworkCore.Database.Connection": "Information",
      "Microsoft.EntityFrameworkCore.Database.Transaction": "Information",
      "Microsoft.EntityFrameworkCore.Update": "Information",
      "Microsoft.EntityFrameworkCore.Migrations": "Information",
      "WileyWidget.Services": "Trace",
      "WileyWidget.WinForms.ViewModels": "Trace",
      "WileyWidget.WinForms.Forms": "Trace"
    }
  },
  "UI": {
    "UIMode": "DockingOnly",
    "UseDockingManager": true,
    "AutoShowDashboard": true,
    "MinimalMode": true,
    "AutoShowPanels": false,
    "Theme": "Office2019Colorful",
    "FiscalYear": 2026,
    "DefaultFiscalYear": 2026
  },

  "Validation": {
    "DiValidationEnabled": true,
    "FastValidation": true
  },

  "SYNCFUSION_LICENSE_KEY": "YOUR_SYNCFUSION_LICENSE_KEY",

  "Syncfusion": {
    "LicenseKey": "YOUR_SYNCFUSION_LICENSE_KEY"
  },

  "AllowedHosts": "*",

  "XAI": {
    "Enabled": true,
    "_ApiKey_WARNING_": "DO NOT STORE REAL API KEYS IN THIS FILE! Use: (1) dotnet user-secrets set 'XAI:ApiKey' 'your-key' OR (2) Environment Variable: XAI__ApiKey. See docs/E2E_XAI_API_CONFIGURATION_FLOW.md",
    "Endpoint": "https://api.x.ai/v1/responses",
    "Model": "grok-4-1-fast-reasoning",
    "Temperature": 0.3,
    "MaxTokens": 800,
    "DisableSemanticKernelConnector": true,
    "_NOTE_": "xAI API uses /v1/responses endpoint (not OpenAI-compatible /chat/completions), so SK connector registration is disabled. HTTP-only fallback works perfectly with /responses endpoint.",
    "Tools": {
      "_DOCS_": "xAI Built-in Tools - Execute server-side on xAI infrastructure. See https://docs.x.ai/developers/tools/overview",
      "Enabled": true,
      "WebSearch": {
        "Enabled": true,
        "EnableImageUnderstanding": false,
        "AllowedDomains": [],
        "ExcludedDomains": [],
        "_USAGE_": "Real-time web search for current regulations (GASB updates), market data (bond yields), legislation changes"
      },
      "CodeExecution": {
        "Enabled": true,
        "TimeoutSeconds": 60,
        "_USAGE_": "Python sandbox with pandas, numpy, scipy, matplotlib for financial modeling, forecasting (ARIMA), ratio calculations, scenario analysis"
      },
      "XSearch": {
        "Enabled": false,
        "EnableImageUnderstanding": false,
        "_USAGE_": "Search X (Twitter) for public sentiment on utility rates, council decisions, taxpayer discourse. Enable when needed."
      },
      "CollectionsSearch": {
        "Enabled": false,
        "CollectionIds": [],
        "_USAGE_": "Query uploaded PDFs (audit reports, budget docs, compliance guidelines). Requires documents uploaded to xAI console first."
      }
    }
  },

  "QuickBooks": {
    "Enabled": true
  },

  "Startup": {
    "TimeoutSeconds": 120,
    "EnableDiValidation": true,
    "EnableThemeValidation": true,
    "EnableLicenseValidation": true,
    "PhaseTimeouts": {
      "DockingInitMs": 15000,
      "ViewModelInitMs": 10000,
      "DataLoadMs": 8000
    }
  },

  "HttpClients": {
    "GrokClient": {
      "Timeout": "00:00:15",
      "RetryAttempts": 3,
      "BackoffMs": 600,
      "CircuitBreakerFailureRatio": 0.5,
      "CircuitBreakerBreakDurationMin": 2
    },
    "QuickBooksClient": {
      "Timeout": "00:00:10",
      "RetryAttempts": 5,
      "BackoffMs": 1000,
      "CircuitBreakerFailureRatio": 0.5,
      "CircuitBreakerBreakDurationMin": 2,
      "Handle429": true,
      "Handle5xx": true
    }
  },

  "Services": {
    "AILogging": {
      "EnableAudit": true,
      "BufferSize": 1000
    },
    "QuickBooks": {
      "RateLimitPerMinute": 100,
      "CacheTokens": true,
      "MaxRetryAttempts": 5,
      "OAuth": {
        "ClientId": "YOUR_CLIENT_ID",
        "ClientSecret": "",
        "RedirectUri": "https://localhost:5001/",
        "Environment": "sandbox",
        "AuthorizationEndpoint": "https://appcenter.intuit.com/connect/oauth2",
        "TokenEndpoint": "https://oauth.platform.intuit.com/oauth2/v1/tokens/bearer",
        "RevokeEndpoint": "https://developer.intuit.com/v2/oauth"
      },
      "Scopes": ["com.intuit.quickbooks.accounting"],
      "TokenCachePath": "./cache/qb-tokens.json",
      "EnableTokenPersistence": true,
      "Webhooks": {
        "EndpointUrl": "https://app.townofwiley.gov/qbo/webhooks",
        "VerifierToken": ""
      },
      "App": {
        "HostDomain": "app.townofwiley.gov",
        "LaunchUrl": "https://app.townofwiley.gov/app/launch",
        "DisconnectUrl": "https://app.townofwiley.gov/app/disconnect",
        "EulaUrl": "https://app.townofwiley.gov/eula",
        "PrivacyPolicyUrl": "https://app.townofwiley.gov/privacy"
      }
    },
    "DataAnonymizer": {
      "EnableCaching": true,
      "CacheExpirationMinutes": 60
    },
    "ReportExport": {
      "DefaultFormat": "PDF",
      "MaxConcurrentExports": 5,
      "TemporaryStorageDir": "./temp-exports"
    },
    "BudgetForecasting": {
      "DefaultInflationRate": 0.035,
      "InflationSource": "Historical trend analysis (3-year average) or manual override",
      "HistoricalYearsToAnalyze": 3,
      "EnableAiRecommendations": true,
      "DefaultExportPath": "Reports/BudgetForecasts"
    }
  }
}

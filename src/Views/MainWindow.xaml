<Window x:Class="WileyWidget.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:prism="http://prismlibrary.com/"
        xmlns:syncfusion="http://schemas.syncfusion.com/wpf"
        xmlns:syncfusionskin="clr-namespace:Syncfusion.SfSkinManager;assembly=Syncfusion.SfSkinManager.WPF"
        xmlns:vm="clr-namespace:WileyWidget.ViewModels"
        xmlns:views="clr-namespace:WileyWidget.Views"
        Title="Wiley Widget - Municipal Enterprise Management"
        Height="768" Width="1280"
        MinHeight="600" MinWidth="1024"
        WindowState="Maximized"
        WindowStartupLocation="CenterScreen"
        ShowInTaskbar="True"
        prism:ViewModelLocator.AutoWireViewModel="True"
        DataContext="{Binding}">

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <!-- Theme resources -->
                <ResourceDictionary Source="/Themes/Generic.xaml"/>
                <ResourceDictionary Source="/Themes/WileyTheme.xaml"/>
                <!-- Data templates for ViewModels -->
                <ResourceDictionary Source="/Resources/DataTemplates.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>

    <!-- Apply Syncfusion theme at window level -->
    <Grid syncfusionskin:SfSkinManager.VisualStyle="FluentDark">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Main Ribbon in Row 0 -->
        <syncfusion:Ribbon x:Name="MainRibbon" Grid.Row="0">
            <syncfusion:RibbonTab Caption="Home" IsChecked="True">
                <syncfusion:RibbonBar Header="Navigation">
                    <syncfusion:RibbonButton Label="Dashboard"
                                           SizeForm="Large"
                                           Command="{Binding NavigateToDashboardCommand}"
                                           LargeIcon="pack://application:,,,/Resources/dashboard-32.png"/>
                    <syncfusion:RibbonButton Label="Enterprises"
                                           SizeForm="Large"
                                           Command="{Binding NavigateToEnterprisesCommand}"
                                           LargeIcon="pack://application:,,,/Resources/enterprise-32.png"/>
                    <syncfusion:RibbonButton Label="Accounts"
                                           SizeForm="Large"
                                           Command="{Binding NavigateToAccountsCommand}"
                                           LargeIcon="pack://application:,,,/Resources/account-32.png"/>
                    <syncfusion:RibbonButton Label="Budget"
                                           SizeForm="Large"
                                           Command="{Binding NavigateToBudgetCommand}"
                                           LargeIcon="pack://application:,,,/Resources/budget-32.png"/>
                </syncfusion:RibbonBar>
                <syncfusion:RibbonBar Header="Tools">
                    <syncfusion:RibbonButton Label="Settings"
                                           Command="{Binding OpenSettingsCommand}"/>
                    <syncfusion:RibbonButton Label="Reports"
                                           Command="{Binding OpenReportsCommand}"/>
                    <syncfusion:RibbonButton Label="AI Assist"
                                           Command="{Binding OpenAIAssistCommand}"/>
                </syncfusion:RibbonBar>
            </syncfusion:RibbonTab>
            <syncfusion:RibbonTab Caption="Data">
                <syncfusion:RibbonBar Header="Import/Export">
                    <syncfusion:RibbonButton Label="Import Excel"
                                           Command="{Binding ImportExcelCommand}"/>
                    <syncfusion:RibbonButton Label="Export Data"
                                           Command="{Binding ExportDataCommand}"/>
                    <syncfusion:RibbonButton Label="Sync QuickBooks"
                                           Command="{Binding SyncQuickBooksCommand}"/>
                </syncfusion:RibbonBar>
            </syncfusion:RibbonTab>
            <syncfusion:RibbonTab Caption="Dashboard">
                <syncfusion:RibbonBar Header="Views">
                    <syncfusion:RibbonButton Label="Show Dashboard"
                                           Command="{Binding ShowDashboardCommand}"/>
                    <syncfusion:RibbonButton Label="Analytics"
                                           Command="{Binding ShowAnalyticsCommand}"/>
                </syncfusion:RibbonBar>
                <syncfusion:RibbonBar Header="Refresh">
                    <syncfusion:RibbonButton Label="Refresh All"
                                           Command="{Binding RefreshAllCommand}"/>
                    <!-- <syncfusion:RibbonButton Label="Auto Refresh"
                                           IsChecked="{Binding IsAutoRefreshEnabled}"/> -->
                </syncfusion:RibbonBar>
            </syncfusion:RibbonTab>
            <syncfusion:RibbonTab Caption="Budget">
                <syncfusion:RibbonBar Header="Management">
                    <syncfusion:RibbonButton Label="New Budget"
                                           Command="{Binding CreateNewBudgetCommand}"/>
                    <syncfusion:RibbonButton Label="Import Budget"
                                           Command="{Binding ImportBudgetCommand}"/>
                    <syncfusion:RibbonButton Label="Export Budget"
                                           Command="{Binding ExportBudgetCommand}"/>
                </syncfusion:RibbonBar>
                <syncfusion:RibbonBar Header="Analysis">
                    <syncfusion:RibbonButton Label="Budget Analysis"
                                           Command="{Binding ShowBudgetAnalysisCommand}"/>
                    <syncfusion:RibbonButton Label="Rate Calculator"
                                           Command="{Binding ShowRateCalculatorCommand}"/>
                </syncfusion:RibbonBar>
            </syncfusion:RibbonTab>
            <syncfusion:RibbonTab Caption="Enterprise">
                <syncfusion:RibbonBar Header="Management">
                    <syncfusion:RibbonButton Label="Add Enterprise"
                                           Command="{Binding AddEnterpriseCommand}"/>
                    <syncfusion:RibbonButton Label="Edit Enterprise"
                                           Command="{Binding EditEnterpriseCommand}"/>
                    <syncfusion:RibbonButton Label="Delete Enterprise"
                                           Command="{Binding DeleteEnterpriseCommand}"/>
                </syncfusion:RibbonBar>
                <syncfusion:RibbonBar Header="Operations">
                    <syncfusion:RibbonButton Label="Service Charges"
                                           Command="{Binding ManageServiceChargesCommand}"/>
                    <syncfusion:RibbonButton Label="Utility Bills"
                                           Command="{Binding ManageUtilityBillsCommand}"/>
                </syncfusion:RibbonBar>
            </syncfusion:RibbonTab>
            <syncfusion:RibbonTab Caption="Reports">
                <syncfusion:RibbonBar Header="Standard Reports">
                    <syncfusion:RibbonButton Label="Financial Summary"
                                           Command="{Binding GenerateFinancialSummaryCommand}"/>
                    <syncfusion:RibbonButton Label="Budget vs Actual"
                                           Command="{Binding GenerateBudgetVsActualCommand}"/>
                    <syncfusion:RibbonButton Label="Enterprise Performance"
                                           Command="{Binding GenerateEnterprisePerformanceCommand}"/>
                </syncfusion:RibbonBar>
                <syncfusion:RibbonBar Header="Custom Reports">
                    <syncfusion:RibbonButton Label="Create Report"
                                           Command="{Binding CreateCustomReportCommand}"/>
                    <syncfusion:RibbonButton Label="Saved Reports"
                                           Command="{Binding ShowSavedReportsCommand}"/>
                </syncfusion:RibbonBar>
            </syncfusion:RibbonTab>
        </syncfusion:Ribbon>

        <!-- DockingManager in Row 1 -->
        <syncfusion:DockingManager x:Name="MainDockingManager"
                                 Grid.Row="1"
                                 UseDocumentContainer="True"
                                 ContainerMode="TDI"
                                 PersistState="True"
                                 MaximizeButtonEnabled="True"
                                 MinimizeButtonEnabled="True"
                                 MaximizeMode="FullScreen"
                                 IsEnableHotTracking="True"
                                 CollapseDefaultContextMenuItemsInDock="False"
                                 UseLayoutRounding="True"
                                 EnableScrollableSidePanel="True"
                                 IsVS2010DraggingEnabled="True"
                                 DockStateChanged="DockingManager_DockStateChanged">

            <!-- Dashboard Region (Main Document Area) -->
            <ContentControl x:Name="DashboardRegion"
                          prism:RegionManager.RegionName="DashboardRegion"
                          syncfusion:DockingManager.State="Document"
                          syncfusion:DockingManager.Header="Dashboard"
                          syncfusion:DockingManager.CanClose="False"/>

            <!-- Enterprise Region -->
            <ContentControl x:Name="EnterpriseRegion"
                          prism:RegionManager.RegionName="EnterpriseRegion"
                          syncfusion:DockingManager.State="Document"
                          syncfusion:DockingManager.Header="Enterprises"
                          syncfusion:DockingManager.CanClose="True"/>

            <!-- Budget Region -->
            <ContentControl x:Name="BudgetRegion"
                          prism:RegionManager.RegionName="BudgetRegion"
                          syncfusion:DockingManager.State="Document"
                          syncfusion:DockingManager.Header="Budget"
                          syncfusion:DockingManager.CanClose="True"/>

            <!-- Municipal Accounts Region -->
            <ContentControl x:Name="MunicipalAccountRegion"
                          prism:RegionManager.RegionName="MunicipalAccountRegion"
                          syncfusion:DockingManager.State="Document"
                          syncfusion:DockingManager.Header="Municipal Accounts"
                          syncfusion:DockingManager.CanClose="True"/>

            <!-- Utility Customers Region -->
            <ContentControl x:Name="UtilityCustomerRegion"
                          prism:RegionManager.RegionName="UtilityCustomerRegion"
                          syncfusion:DockingManager.State="Document"
                          syncfusion:DockingManager.Header="Utility Customers"
                          syncfusion:DockingManager.CanClose="True"/>

            <!-- Reports Region -->
            <ContentControl x:Name="ReportsRegion"
                          prism:RegionManager.RegionName="ReportsRegion"
                          syncfusion:DockingManager.State="Document"
                          syncfusion:DockingManager.Header="Reports"
                          syncfusion:DockingManager.CanClose="True"/>

            <!-- Analytics Region -->
            <ContentControl x:Name="AnalyticsRegion"
                          prism:RegionManager.RegionName="AnalyticsRegion"
                          syncfusion:DockingManager.State="Document"
                          syncfusion:DockingManager.Header="Analytics"
                          syncfusion:DockingManager.CanClose="True"/>

            <!-- Left Panel: Navigation/Tree -->
            <ContentControl x:Name="LeftPanelRegion"
                          prism:RegionManager.RegionName="LeftPanelRegion"
                          syncfusion:DockingManager.State="Dock"
                          syncfusion:DockingManager.SideInDockedMode="Left"
                          syncfusion:DockingManager.DesiredWidthInDockedMode="280"
                          syncfusion:DockingManager.Header="Navigation"
                          syncfusion:DockingManager.CanClose="False"/>

            <!-- Right Panel: Properties/Details -->
            <ContentControl x:Name="RightPanelRegion"
                          prism:RegionManager.RegionName="RightPanelRegion"
                          syncfusion:DockingManager.State="Dock"
                          syncfusion:DockingManager.SideInDockedMode="Right"
                          syncfusion:DockingManager.DesiredWidthInDockedMode="320"
                          syncfusion:DockingManager.Header="Properties"
                          syncfusion:DockingManager.CanClose="False"/>

            <!-- Bottom Panel: Logs/Alerts -->
            <ContentControl x:Name="BottomPanelRegion"
                          prism:RegionManager.RegionName="BottomPanelRegion"
                          syncfusion:DockingManager.State="Dock"
                          syncfusion:DockingManager.SideInDockedMode="Bottom"
                          syncfusion:DockingManager.DesiredHeightInDockedMode="180"
                          syncfusion:DockingManager.Header="System Alerts"
                          syncfusion:DockingManager.CanClose="False"/>
        </syncfusion:DockingManager>
    </Grid>
</Window>
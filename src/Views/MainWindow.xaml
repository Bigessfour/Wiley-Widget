<Window x:Class="WileyWidget.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:prism="http://prismlibrary.com/"
        xmlns:syncfusion="http://schemas.syncfusion.com/wpf"
        xmlns:syncfusionskin="clr-namespace:Syncfusion.SfSkinManager;assembly=Syncfusion.SfSkinManager.WPF"
        xmlns:vm="clr-namespace:WileyWidget.ViewModels"
        xmlns:converters="clr-namespace:WileyWidget.Converters"
        Title="{Binding CurrentViewTitle, FallbackValue='Wiley Widget - Municipal Enterprise Management'}"
        AutomationProperties.Name="Main Application Window"
        xml:lang="en-US"
        FocusVisualStyle="{DynamicResource {x:Static SystemParameters.FocusVisualStyleKey}}"
        KeyboardNavigation.TabNavigation="Cycle"
        KeyboardNavigation.ControlTabNavigation="Cycle"
        KeyboardNavigation.DirectionalNavigation="Cycle"
        Height="768" Width="1280"
        MinHeight="600" MinWidth="1024"
        WindowState="Maximized"
        WindowStartupLocation="CenterScreen"
        ShowInTaskbar="True"
        Visibility="Hidden"
        prism:ViewModelLocator.AutoWireViewModel="True"
        DataContext="{Binding}">

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <!-- Theme resources -->
                <ResourceDictionary Source="../Themes/Generic.xaml"/>
                <ResourceDictionary Source="../Themes/WileyTheme.xaml"/>
                <!-- Data templates for ViewModels -->
                <ResourceDictionary Source="../Resources/DataTemplates.xaml"/>
            </ResourceDictionary.MergedDictionaries>

            <!-- Converters -->
            <converters:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
            <converters:NullToVisibilityConverter x:Key="NullToVisibilityConverter"/>
            <converters:StringToVisibilityConverter x:Key="StringToVisibilityConverter"/>
        </ResourceDictionary>
    </Window.Resources>

    <!-- Apply Syncfusion theme globally via SfSkinManager.ApplicationTheme -->
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Main Ribbon in Row 0 -->
        <syncfusion:Ribbon x:Name="MainRibbon" 
                          Grid.Row="0"
                          AutomationProperties.Name="Main Application Ribbon"
                          AutomationProperties.HelpText="Main navigation and command ribbon">
            
            <!-- Quick Access Toolbar -->
            <syncfusion:Ribbon.QuickAccessToolBar>
                <syncfusion:QuickAccessToolBar>
                    <syncfusion:RibbonButton Label="Save" 
                                           SizeForm="ExtraSmall"
                                           ToolTip="Save current work (Ctrl+S)"/>
                    <syncfusion:RibbonButton Label="Refresh" 
                                           SizeForm="ExtraSmall"
                                           Command="{Binding RefreshAllCommand}"
                                           ToolTip="Refresh all data (F5)"/>
                </syncfusion:QuickAccessToolBar>
            </syncfusion:Ribbon.QuickAccessToolBar>

            <syncfusion:RibbonTab Caption="Home" IsChecked="True">
                <syncfusion:RibbonBar Header="Navigation">
                    <syncfusion:RibbonButton Label="Dashboard"
                                           SizeForm="Large"
                                           Command="{Binding NavigateToDashboardCommand}"
                                           ToolTip="Navigate to Dashboard (Ctrl+1)"/>
                    <syncfusion:RibbonButton Label="Enterprises"
                                           SizeForm="Large"
                                           Command="{Binding NavigateToEnterprisesCommand}"
                                           ToolTip="Navigate to Enterprises (Ctrl+2)"/>
                    <syncfusion:RibbonButton Label="Accounts"
                                           SizeForm="Large"
                                           Command="{Binding NavigateToAccountsCommand}"
                                           ToolTip="Navigate to Municipal Accounts (Ctrl+3)"/>
                    <syncfusion:RibbonButton Label="Budget"
                                           SizeForm="Large"
                                           Command="{Binding NavigateToBudgetCommand}"
                                           ToolTip="Navigate to Budget Management (Ctrl+4)"/>
                </syncfusion:RibbonBar>
                <syncfusion:RibbonBar Header="Tools">
                    <syncfusion:RibbonButton Label="Settings"
                                           SizeForm="Small"
                                           Command="{Binding OpenSettingsCommand}"
                                           ToolTip="Open application settings"/>
                    <syncfusion:RibbonButton Label="Reports"
                                           SizeForm="Small"
                                           Command="{Binding OpenReportsCommand}"
                                           ToolTip="View and generate reports"/>
                    <syncfusion:RibbonButton Label="AI Assist"
                                           SizeForm="Small"
                                           Command="{Binding OpenAIAssistCommand}"
                                           ToolTip="Open AI Assistant"/>
                </syncfusion:RibbonBar>
            </syncfusion:RibbonTab>
            <syncfusion:RibbonTab Caption="Data">
                <syncfusion:RibbonBar Header="Import/Export">
                    <syncfusion:RibbonButton Label="Import Excel"
                                           SizeForm="Large"
                                           Command="{Binding ImportExcelCommand}"
                                           ToolTip="Import data from Excel files"/>
                    <syncfusion:RibbonButton Label="Export Data"
                                           SizeForm="Large"
                                           Command="{Binding ExportDataCommand}"
                                           ToolTip="Export data to various formats"/>
                    <syncfusion:RibbonButton Label="Sync QuickBooks"
                                           SizeForm="Large"
                                           Command="{Binding SyncQuickBooksCommand}"
                                           ToolTip="Synchronize with QuickBooks Online"/>
                </syncfusion:RibbonBar>
            </syncfusion:RibbonTab>
            <syncfusion:RibbonTab Caption="Dashboard">
                <syncfusion:RibbonBar Header="Views">
                    <syncfusion:RibbonButton Label="Show Dashboard"
                                           SizeForm="Large"
                                           Command="{Binding ShowDashboardCommand}"
                                           ToolTip="Display main dashboard"/>
                    <syncfusion:RibbonButton Label="Analytics"
                                           SizeForm="Large"
                                           Command="{Binding ShowAnalyticsCommand}"
                                           ToolTip="View advanced analytics"/>
                </syncfusion:RibbonBar>
                <syncfusion:RibbonBar Header="Refresh">
                    <syncfusion:RibbonButton Label="Refresh All"
                                           SizeForm="Large"
                                           Command="{Binding RefreshAllCommand}"
                                           ToolTip="Refresh all data sources (F5)"/>
                    <syncfusion:RibbonButton Label="Refresh View"
                                           SizeForm="Small"
                                           Command="{Binding RefreshCommand}"
                                           ToolTip="Refresh current view"/>
                </syncfusion:RibbonBar>
            </syncfusion:RibbonTab>
            <syncfusion:RibbonTab Caption="Budget">
                <syncfusion:RibbonBar Header="Management">
                    <syncfusion:RibbonButton Label="New Budget"
                                           SizeForm="Large"
                                           Command="{Binding CreateNewBudgetCommand}"
                                           ToolTip="Create a new fiscal year budget"/>
                    <syncfusion:RibbonButton Label="Import Budget"
                                           SizeForm="Small"
                                           Command="{Binding ImportBudgetCommand}"
                                           ToolTip="Import budget from file"/>
                    <syncfusion:RibbonButton Label="Export Budget"
                                           SizeForm="Small"
                                           Command="{Binding ExportBudgetCommand}"
                                           ToolTip="Export budget to file"/>
                </syncfusion:RibbonBar>
                <syncfusion:RibbonBar Header="Analysis">
                    <syncfusion:RibbonButton Label="Budget Analysis"
                                           SizeForm="Large"
                                           Command="{Binding ShowBudgetAnalysisCommand}"
                                           ToolTip="View budget vs actual analysis"/>
                    <syncfusion:RibbonButton Label="Rate Calculator"
                                           SizeForm="Large"
                                           Command="{Binding ShowRateCalculatorCommand}"
                                           ToolTip="Calculate utility rates"/>
                </syncfusion:RibbonBar>
            </syncfusion:RibbonTab>
            <syncfusion:RibbonTab Caption="Enterprise">
                <syncfusion:RibbonBar Header="Management">
                    <syncfusion:RibbonButton Label="Add Enterprise"
                                           SizeForm="Large"
                                           Command="{Binding AddEnterpriseCommand}"
                                           ToolTip="Add new enterprise (Ctrl+N)"/>
                    <syncfusion:RibbonButton Label="Edit Enterprise"
                                           SizeForm="Small"
                                           Command="{Binding EditEnterpriseCommand}"
                                           ToolTip="Edit selected enterprise (Ctrl+E)"/>
                    <syncfusion:RibbonButton Label="Delete Enterprise"
                                           SizeForm="Small"
                                           Command="{Binding DeleteEnterpriseCommand}"
                                           ToolTip="Delete selected enterprise (Delete)"/>
                </syncfusion:RibbonBar>
                <syncfusion:RibbonBar Header="Operations">
                    <syncfusion:RibbonButton Label="Service Charges"
                                           SizeForm="Large"
                                           Command="{Binding ManageServiceChargesCommand}"
                                           ToolTip="Manage enterprise service charges"/>
                    <syncfusion:RibbonButton Label="Utility Bills"
                                           SizeForm="Large"
                                           Command="{Binding ManageUtilityBillsCommand}"
                                           ToolTip="Manage utility billing"/>
                </syncfusion:RibbonBar>
            </syncfusion:RibbonTab>
            <syncfusion:RibbonTab Caption="Reports">
                <syncfusion:RibbonBar Header="Standard Reports">
                    <syncfusion:RibbonButton Label="Financial Summary"
                                           SizeForm="Large"
                                           Command="{Binding GenerateFinancialSummaryCommand}"
                                           ToolTip="Generate financial summary report"/>
                    <syncfusion:RibbonButton Label="Budget vs Actual"
                                           SizeForm="Large"
                                           Command="{Binding GenerateBudgetVsActualCommand}"
                                           ToolTip="Generate budget comparison report"/>
                    <syncfusion:RibbonButton Label="Enterprise Performance"
                                           SizeForm="Large"
                                           Command="{Binding GenerateEnterprisePerformanceCommand}"
                                           ToolTip="Generate enterprise performance report"/>
                </syncfusion:RibbonBar>
                <syncfusion:RibbonBar Header="Custom Reports">
                    <syncfusion:RibbonButton Label="Create Report"
                                           SizeForm="Large"
                                           Command="{Binding CreateCustomReportCommand}"
                                           ToolTip="Build custom report"/>
                    <syncfusion:RibbonButton Label="Saved Reports"
                                           SizeForm="Large"
                                           Command="{Binding ShowSavedReportsCommand}"
                                           ToolTip="View saved reports"/>
                </syncfusion:RibbonBar>
            </syncfusion:RibbonTab>
        </syncfusion:Ribbon>

        <!-- DockingManager with Complete Region Configuration -->
        <syncfusion:DockingManager x:Name="MainDockingManager"
                                 Grid.Row="1"
                                 AutomationProperties.Name="Main Docking Manager"
                                 AutomationProperties.HelpText="Main content area with dockable panels"
                                 UseDocumentContainer="True"
                                 ContainerMode="TDI"
                                 PersistState="False"
                                 DockToFill="True"
                                 IsVS2010DraggingEnabled="True"
                                 DockStateChanged="DockingManager_DockStateChanged"
                                 ActiveWindowChanged="DockingManager_ActiveWindowChanged">

            <!-- Document Regions (Tabbed Interface) -->
            <ContentControl x:Name="DashboardRegion"
                          prism:RegionManager.RegionName="DashboardRegion"
                          syncfusion:DockingManager.State="Document"
                          syncfusion:DockingManager.Header="Dashboard"
                          syncfusion:DockingManager.CanClose="False"
                          MinWidth="400" MinHeight="300"/>

            <ContentControl x:Name="EnterpriseRegion"
                          prism:RegionManager.RegionName="EnterpriseRegion"
                          syncfusion:DockingManager.State="Document"
                          syncfusion:DockingManager.Header="Enterprises"
                          syncfusion:DockingManager.CanClose="False"
                          MinWidth="400" MinHeight="300"/>

            <ContentControl x:Name="MunicipalAccountRegion"
                          prism:RegionManager.RegionName="MunicipalAccountRegion"
                          syncfusion:DockingManager.State="Document"
                          syncfusion:DockingManager.Header="Municipal Accounts"
                          syncfusion:DockingManager.CanClose="False"
                          MinWidth="400" MinHeight="300"/>

            <ContentControl x:Name="BudgetRegion"
                          prism:RegionManager.RegionName="BudgetRegion"
                          syncfusion:DockingManager.State="Document"
                          syncfusion:DockingManager.Header="Budget"
                          syncfusion:DockingManager.CanClose="False"
                          MinWidth="400" MinHeight="300"/>

            <ContentControl x:Name="AIAssistRegion"
                          prism:RegionManager.RegionName="AIAssistRegion"
                          syncfusion:DockingManager.State="Document"
                          syncfusion:DockingManager.Header="AI Assistant"
                          syncfusion:DockingManager.CanClose="False"
                          MinWidth="400" MinHeight="300"/>

            <ContentControl x:Name="AnalyticsRegion"
                          prism:RegionManager.RegionName="AnalyticsRegion"
                          syncfusion:DockingManager.State="Document"
                          syncfusion:DockingManager.Header="Analytics"
                          syncfusion:DockingManager.CanClose="False"
                          MinWidth="400" MinHeight="300"/>

            <ContentControl x:Name="SettingsRegion"
                          prism:RegionManager.RegionName="SettingsRegion"
                          syncfusion:DockingManager.State="Document"
                          syncfusion:DockingManager.Header="Settings"
                          syncfusion:DockingManager.CanClose="False"
                          MinWidth="400" MinHeight="300"/>

            <ContentControl x:Name="ReportsRegion"
                          prism:RegionManager.RegionName="ReportsRegion"
                          syncfusion:DockingManager.State="Document"
                          syncfusion:DockingManager.Header="Reports"
                          syncfusion:DockingManager.CanClose="False"
                          MinWidth="400" MinHeight="300"/>

            <!-- Panel Regions (Fixed Docking Positions) -->
            <ContentControl x:Name="LeftPanelRegion"
                          prism:RegionManager.RegionName="LeftPanelRegion"
                          syncfusion:DockingManager.State="Dock"
                          syncfusion:DockingManager.SideInDockedMode="Left"
                          syncfusion:DockingManager.DesiredWidthInDockedMode="280"
                          syncfusion:DockingManager.Header="Navigation"
                          syncfusion:DockingManager.CanClose="False"/>

            <ContentControl x:Name="RightPanelRegion"
                          prism:RegionManager.RegionName="RightPanelRegion"
                          syncfusion:DockingManager.State="Dock"
                          syncfusion:DockingManager.SideInDockedMode="Right"
                          syncfusion:DockingManager.DesiredWidthInDockedMode="320"
                          syncfusion:DockingManager.Header="Properties"
                          syncfusion:DockingManager.CanClose="False"/>

            <ContentControl x:Name="BottomPanelRegion"
                          prism:RegionManager.RegionName="BottomPanelRegion"
                          syncfusion:DockingManager.State="Dock"
                          syncfusion:DockingManager.SideInDockedMode="Bottom"
                          syncfusion:DockingManager.DesiredHeightInDockedMode="180"
                          syncfusion:DockingManager.Header="System Alerts"
                          syncfusion:DockingManager.CanClose="False"/>
        </syncfusion:DockingManager>

        <!-- Status Bar in Row 2 -->
        <StatusBar Grid.Row="2"
                   AutomationProperties.Name="Application Status Bar"
                   AutomationProperties.HelpText="Application status and current view information">
            <StatusBarItem>
                <TextBlock Text="{Binding CurrentViewTitle, StringFormat='Current View: {0}'}"
                          AutomationProperties.Name="Current View Display"/>
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right">
                <TextBlock Text="{Binding CurrentTheme, StringFormat='Theme: {0}'}"
                          AutomationProperties.Name="Current Theme Display"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
# PowerShell 7.5.2 Development EnvironmentThis project is configured for PowerShell 7.5.2 development with GitHub Copilot support, following Microsoft best practices and approved verbs.## üöÄ Quick Start1. **Install PowerShell 7.5.2** from [Microsoft's official site](https://github.com/PowerShell/PowerShell/releases)2. **Install VS Code** with the PowerShell extension (`ms-vscode.powershell`)3. **Run setup script**:   ```powershell   .\scripts\Setup-PowerShell-Development.ps1 -InstallTools -UpdateVSCodeSettings -VerifySetup   ```## üìã VS Code Configuration### Essential Settings for PowerShell 7.5.2 Support```json{    "powershell.powerShellDefaultVersion": "7.5.2",    "powershell.powerShellExePath": "C:\\Program Files\\PowerShell\\7\\pwsh.exe",    "powershell.enableProfileLoading": true,    "powershell.enableReferencesCodeLens": true,    "powershell.enableScriptAnalysis": true,    "powershell.scriptAnalysis.settingsPath": ".vscode\\PSScriptAnalyzerSettings.psd1",    "powershell.codeFormatting.preset": "OTBS",    "powershell.codeFormatting.autoCorrectAliases": true,    "powershell.codeFormatting.useCorrectCasing": true}```### Required VS Code Extensions```vscode-extensionsms-vscode.powershell,pspester.pester-test,ms-dotnettools.dotnet-interactive-vscode```## üõ†Ô∏è Development Tools### PowerShell Modules- **PSScriptAnalyzer** - Static code analysis and linting- **Pester** - Testing framework- **platyPS** - Help documentation generation- **PSReadLine** - Enhanced command-line editing- **PSFramework** - PowerShell development framework### Trunk CI/CD Integration- **PowerShell linter** - Enforces 7.5.2 compatibility- **PSScriptAnalyzer rules** - Code quality and best practices- **Automated testing** - Pester test execution## üìö PowerShell 7.5.2 Best Practices### ‚úÖ Approved VerbsUse only Microsoft-approved verbs:- `Get`, `Set`, `Test`, `Invoke`, `New`, `Remove`, `Add`, `Clear`, `Write`, `Read`- Full list: `Get-Verb`### ‚úÖ Code Style```powershell# Function naming: Verb-Nounfunction Get-WileyWidgetConfig {    [CmdletBinding()]    param(        [Parameter(Mandatory)]        [string]$configPath,        [switch]$forceReload    )    try {        Write-Verbose "Loading configuration from: $configPath" -Verbose:$VerbosePreference        # Implementation here    }    catch {        Write-Error "Failed to load configuration: $_"        throw    }}```### ‚ùå Avoid These Patterns```powershell# Don't use Write-HostWrite-Host "Processing..." -ForegroundColor Green  # ‚ùå# Use approved verbs onlyfunction Show-Data { }  # ‚ùå Use Get-Data instead# Avoid unapproved verbsfunction Display-Info { }  # ‚ùå Use Write-Output or Write-Verbose```## üîß GitHub Copilot Configuration### Context Files- **`.vscode/GitHub-Copilot-PowerShell-Context.md`** - AI development guidelines- **`.vscode/PowerShell-Development-Config.psd1`** - Tool and version specifications- **`.vscode/PSScriptAnalyzerSettings.psd1`** - Code analysis rules### AI-Assisted DevelopmentGitHub Copilot is configured to:- Understand PowerShell 7.5.2 syntax and features- Suggest approved verbs and naming conventions- Follow Microsoft best practices- Generate compliant PowerShell code- Use proper error handling patterns## üß™ Testing### Pester Test Structure```powershell# File: WileyWidget.Profile.Tests.ps1Describe "Wiley Widget Profile Functions" {    Context "Set-WileyWidgetEnvironment" {        It "Should load environment variables" {            # Test implementation        }    }}```### Running Tests```powershell# Run all testsInvoke-Pester# Run specific test fileInvoke-Pester -Path .\WileyWidget.Profile.Tests.ps1 -Verbose```## üìñ Documentation### Comment-Based HelpAll functions must include comment-based help:```powershell<#.SYNOPSIS    Short description of the function..DESCRIPTION    Detailed description of what the function does..PARAMETER ParameterName    Description of the parameter..EXAMPLE    Example usage of the function..NOTES    Additional notes about the function.#>```### Generate Documentation```powershell# Generate markdown help filesImport-Module platyPSNew-MarkdownHelp -Module WileyWidget.Profile -OutputFolder docs\```## üîí Security Best Practices- Use `SecureString` for sensitive data- Avoid plain text passwords- Validate all input parameters- Use parameter sets for mutually exclusive parameters- Implement proper error handling## üöÄ CI/CD Integration### Trunk Configuration- **PowerShell linting** - Automatic code quality checks- **PSScriptAnalyzer** - Static analysis on every commit- **Test execution** - Automated Pester test runs- **Documentation** - Auto-generated help files### GitHub ActionsThe CI/CD pipeline includes:- PowerShell 7.5.2 compatibility checks- PSScriptAnalyzer rule validation- Pester test execution- Code coverage reporting## üìã Checklist for New PowerShell Code- [ ] Uses approved Microsoft verbs- [ ] Includes comment-based help- [ ] Has proper parameter validation- [ ] Uses Write-Verbose instead of Write-Host- [ ] Includes error handling with try/catch- [ ] Has Pester tests- [ ] Passes PSScriptAnalyzer rules- [ ] Follows camelCase naming convention- [ ] Uses pipeline-friendly patterns## üÜò Troubleshooting### Common Issues1. **PSScriptAnalyzer not working**   - Ensure module is installed: `Install-Module PSScriptAnalyzer`   - Check settings path in VS Code settings2. **PowerShell extension not recognizing 7.5.2**   - Verify PowerShell installation path   - Update VS Code PowerShell extension3. **GitHub Copilot not following guidelines**   - Ensure context files are in `.vscode/` directory   - Check that PowerShell language is properly detected### Getting Help- **PowerShell Documentation**: https://docs.microsoft.com/powershell/- **PSScriptAnalyzer**: https://github.com/PowerShell/PSScriptAnalyzer- **Pester**: https://pester.dev/- **VS Code PowerShell**: https://github.com/PowerShell/vscode-powershell---**Happy PowerShell 7.5.2 Development!** üéâ

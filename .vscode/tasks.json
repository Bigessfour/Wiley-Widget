{
	"version": "2.0.0",
	"tasks": [
		{
			"label": "kill-processes",
			"type": "shell",
			"command": "pwsh",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/scripts/maintenance/cleanup-dotnet-processes.ps1"
			],
			"presentation": {
				"reveal": "silent",
				"panel": "shared"
			},
			"problemMatcher": []
		},
		{
			"label": "clean",
			"type": "shell",
			"command": "dotnet",
			"args": [
				"clean",
				"${workspaceFolder}/Wiley-Widget.slnx",
				"--verbosity",
				"minimal",
				"/p:Platform=x64"
			],
			"presentation": {
				"reveal": "silent",
				"panel": "shared"
			},
			"problemMatcher": "$msCompile",
			"dependsOn": "kill-processes"
		},
		{
			"label": "build",
			"type": "shell",
			"command": "dotnet",
			"args": [
				"build",
				"${workspaceFolder}/Wiley-Widget.csproj",
				"--configuration",
				"Debug",
				"/p:Platform=x64",
				"--verbosity",
				"diagnostic",
				"--no-incremental",
				"/bl:${workspaceFolder}/xaml-debug.binlog",
				"/p:XamlDebuggingInformation=true",
				"/p:GenerateXamlDebuggingInformation=true"
			],
			"group": {
				"kind": "build",
				"isDefault": true
			},
			"presentation": {
				"reveal": "always",
				"panel": "dedicated",
				"focus": true,
				"clear": true
			},
			"problemMatcher": "$msCompile",
			"dependsOn": "clean"
		},
		{
			"label": "restore",
			"type": "shell",
			"command": "dotnet",
			"args": [
				"restore",
				"${workspaceFolder}/Wiley-Widget.slnx"
			],
			"presentation": {
				"reveal": "always",
				"panel": "shared"
			},
			"problemMatcher": []
		},
		{
			"label": "run",
			"type": "shell",
			"command": "${workspaceFolder}/bin/x64/Debug/net8.0-windows10.0.19041.0/Wiley-Widget.exe",
			"presentation": {
				"reveal": "always",
				"panel": "dedicated",
				"focus": true
			},
			"isBackground": true,
			"problemMatcher": [],
			"dependsOn": "build"
		},
		{
			"label": "ensure-logs-dir",
			"type": "shell",
			"command": "pwsh",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-Command",
				"if (-not (Test-Path -Path '${workspaceFolder}/logs')) { New-Item -ItemType Directory -Path '${workspaceFolder}/logs' | Out-Null }"
			],
			"presentation": {
				"reveal": "silent",
				"panel": "shared"
			},
			"problemMatcher": []
		},
		{
			"label": "git:update",
			"type": "shell",
			"command": "pwsh",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/scripts/maintenance/git-update.ps1"
			],
			"presentation": {
				"reveal": "always",
				"panel": "dedicated",
				"focus": true,
				"clear": true
			},
			"problemMatcher": []
		},
		{
			"label": "git:update-custom",
			"type": "shell",
			"command": "pwsh",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/scripts/maintenance/git-update.ps1",
				"-Message",
				"${input:commitMessage}"
			],
			"presentation": {
				"reveal": "always",
				"panel": "dedicated",
				"focus": true,
				"clear": true
			},
			"problemMatcher": []
		},
		{
			"label": "mcp:validate-setup",
			"type": "shell",
			"command": "pwsh",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/scripts/tools/validate-mcp-setup.ps1",
				"-Verbose"
			],
			"presentation": {
				"reveal": "always",
				"panel": "shared"
			},
			"problemMatcher": []
		},
		{
			"label": "Run Script (Intelligent)",
			"type": "shell",
			"command": "pwsh",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/scripts/tools/run-script.ps1",
				"-ScriptPath",
				"${input:intelligentScriptPath}",
				"-Verbose"
			],
			"presentation": {
				"reveal": "always",
				"panel": "dedicated",
				"focus": true
			},
			"problemMatcher": []
		},
		{
			"label": "build:xaml-manual",
			"type": "shell",
			"command": "pwsh",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-Command",
				"if (Test-Path 'obj\\x64\\Debug\\net8.0-windows10.0.19041.0\\input.json') { & 'C:\\Users\\biges\\.nuget\\packages\\microsoft.windowsappsdk\\1.7.250909003\\buildTransitive\\..\\tools\\net6.0\\..\\net472\\XamlCompiler.exe' 'obj\\x64\\Debug\\net8.0-windows10.0.19041.0\\input.json' 'obj\\x64\\Debug\\net8.0-windows10.0.19041.0\\output.json' 2>&1 | Tee-Object -FilePath 'xaml-compiler-errors.log' } else { Write-Host 'Run build first to generate input.json' -ForegroundColor Yellow }"
			],
			"presentation": {
				"reveal": "always",
				"panel": "dedicated",
				"focus": true,
				"clear": true
			},
			"problemMatcher": []
		},
		{
			"label": "build:view-binlog",
			"type": "shell",
			"command": "pwsh",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-Command",
				"if (Test-Path 'xaml-debug.binlog') { Start-Process 'https://msbuildlog.com/?logfile=xaml-debug.binlog' } else { Write-Host 'Run build first to generate the binary log' -ForegroundColor Yellow }"
			],
			"presentation": {
				"reveal": "silent",
				"panel": "shared"
			},
			"problemMatcher": []
		}
	],
	"inputs": [
		{
			"id": "commitMessage",
			"type": "promptString",
			"description": "Enter commit message",
			"default": "chore: Update project files"
		},
		{
			"id": "intelligentScriptPath",
			"type": "promptString",
			"description": "Script to run (auto-detects .py, .ps1, .csx)",
			"default": "tests/test_startup_validator.py"
		}
	]
}

{
	"version": "2.0.0",
	"tasks": [
		{
			"label": "kill-processes",
			"type": "shell",
			"command": "pwsh",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/scripts/maintenance/cleanup-dotnet-processes.ps1"
			],
			"presentation": {
				"reveal": "silent",
				"panel": "shared"
			},
			"problemMatcher": []
		},
		{
			"label": "clean",
			"type": "shell",
			"command": "dotnet",
			"args": [
				"clean",
				"${workspaceFolder}/Wiley-Widget.slnx",
				"--verbosity",
				"minimal",
				"/p:Platform=x64"
			],
			"presentation": {
				"reveal": "silent",
				"panel": "shared"
			},
			"problemMatcher": "$msCompile",
			"dependsOn": "kill-processes"
		},
		{
			"label": "build",
			"type": "shell",
			"command": "dotnet",
			"args": [
				"build",
				"${workspaceFolder}/Wiley-Widget.slnx",
				"--no-restore",
				"--configuration",
				"Debug",
				"--verbosity",
				"minimal",
				"/p:Platform=x64"
			],
			"group": {
				"kind": "build",
				"isDefault": true
			},
			"presentation": {
				"reveal": "always",
				"panel": "shared"
			},
			"problemMatcher": "$msCompile",
			"dependsOn": "clean"
		},
		{
			"label": "restore",
			"type": "shell",
			"command": "dotnet",
			"args": [
				"restore",
				"${workspaceFolder}/Wiley-Widget.slnx"
			],
			"presentation": {
				"reveal": "always",
				"panel": "shared"
			},
			"problemMatcher": []
		},
		{
			"label": "run",
			"type": "shell",
			"command": "${workspaceFolder}/bin/x64/Debug/net8.0-windows10.0.26100/Wiley-Widget.exe",
			"presentation": {
				"reveal": "always",
				"panel": "dedicated",
				"focus": true
			},
			"isBackground": true,
			"problemMatcher": [],
			"dependsOn": "build"
		},
		{
			"label": "ensure-logs-dir",
			"type": "shell",
			"command": "pwsh",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-Command",
				"if (-not (Test-Path -Path '${workspaceFolder}/logs')) { New-Item -ItemType Directory -Path '${workspaceFolder}/logs' | Out-Null }"
			],
			"presentation": {
				"reveal": "silent",
				"panel": "shared"
			},
			"problemMatcher": []
		},
		{
			"label": "git:update",
			"type": "shell",
			"command": "pwsh",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/scripts/maintenance/git-update.ps1"
			],
			"presentation": {
				"reveal": "always",
				"panel": "dedicated",
				"focus": true,
				"clear": true
			},
			"problemMatcher": []
		},
		{
			"label": "git:update-custom",
			"type": "shell",
			"command": "pwsh",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/scripts/maintenance/git-update.ps1",
				"-Message",
				"${input:commitMessage}"
			],
			"presentation": {
				"reveal": "always",
				"panel": "dedicated",
				"focus": true,
				"clear": true
			},
			"problemMatcher": []
		},
		{
			"label": "mcp:validate-setup",
			"type": "shell",
			"command": "pwsh",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/scripts/tools/validate-mcp-setup.ps1",
				"-Verbose"
			],
			"presentation": {
				"reveal": "always",
				"panel": "shared"
			},
			"problemMatcher": []
		},
		{
			"label": "Run Script (Intelligent)",
			"type": "shell",
			"command": "pwsh",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/scripts/tools/run-script.ps1",
				"-ScriptPath",
				"${input:intelligentScriptPath}",
				"-Verbose"
			],
			"presentation": {
				"reveal": "always",
				"panel": "dedicated",
				"focus": true
			},
			"problemMatcher": []
		},
		{
			"label": "build:diagnostic-xaml",
			"type": "shell",
			"command": "dotnet",
			"args": [
				"build",
				"${workspaceFolder}/Wiley-Widget.csproj",
				"--configuration",
				"Debug",
				"/p:Platform=x64",
				"--verbosity",
				"diagnostic"
			],
			"presentation": {
				"reveal": "always",
				"panel": "dedicated",
				"focus": true,
				"clear": true
			},
			"problemMatcher": []
		},
		{
			"label": "python:generate-manifest",
			"type": "shell",
			"command": "pwsh",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-Command",
				"& '${workspaceFolder}/.venv/Scripts/Activate.ps1'; python '${workspaceFolder}/scripts/tools/generate_repo_urls.py' --output '${workspaceFolder}/ai-fetchable-manifest.json' --full-tree"
			],
			"presentation": {
				"reveal": "always",
				"panel": "dedicated",
				"focus": true,
				"clear": true
			},
			"problemMatcher": []
		}
	],
	"inputs": [
		{
			"id": "commitMessage",
			"type": "promptString",
			"description": "Enter commit message",
			"default": "chore: Update project files"
		},
		{
			"id": "intelligentScriptPath",
			"type": "promptString",
			"description": "Script to run (auto-detects .py, .ps1, .csx)",
			"default": "tests/test_startup_validator.py"
		}
	]
}

# Wiley Widget Development Guidelines - Python Tooling

## üêç Python-First Development Environment

This project uses a comprehensive Python-based tooling ecosystem that has replaced legacy PowerShell scripts for better cross-platform support, maintainability, and testing capabilities.

## üöÄ Core Development Workflow

### Development Startup
**Use**: `python scripts/dev-start.py` or VS Code task "dev-start"
- Cleans orphaned .NET processes
- Performs build hygiene (`dotnet clean`)
- Applies Azure performance optimizations
- Launches `dotnet watch` with monitoring

### Environment Management
**Use**: `python scripts/load-env.py`
- Loads configuration from `.env` file
- Resolves Azure Key Vault references
- Validates Azure connectivity
- Masks sensitive data in logs

**Commands**:
```bash
python scripts/load-env.py              # Load environment
python scripts/load-env.py --status     # Check status
python scripts/load-env.py --test-connections  # Test Azure
```

### Azure Setup
**Use**: `python scripts/azure-setup.py`
- Configures Azure CLI with proper defaults
- Sets up target subscription
- Tests Azure resource access

**Commands**:
```bash
python scripts/azure-setup.py                    # Full setup
python scripts/azure-setup.py --test-connection  # Test only
```

### Process Cleanup
**Use**: `python scripts/cleanup-dotnet.py`
- Safely removes orphaned .NET processes
- Cleans build artifacts
- Interactive confirmation mode

**Commands**:
```bash
python scripts/cleanup-dotnet.py        # Interactive cleanup
python scripts/cleanup-dotnet.py --force # Force cleanup (CI/CD)
```

## üß™ Testing Framework

### Test Execution
**Use**: pytest with comprehensive test suite
```bash
# Install dependencies
pip install -r requirements-test.txt

# Run tests
pytest                          # All tests
pytest -m "unit"               # Fast unit tests only
pytest -m "integration"        # Integration tests
pytest -m "azure"              # Azure-dependent tests
pytest --cov=scripts           # With coverage
pytest -n auto                 # Parallel execution
```

### Test Structure
- **Unit tests**: Fast, isolated function testing
- **Integration tests**: Cross-component testing
- **Azure tests**: Cloud resource testing
- **UI tests**: Interface testing

## üìã VS Code Integration

### Available Tasks
- `dev-start`: Main development startup
- `cleanup-dotnet`: Process cleanup
- `load-env`: Environment loading
- `azure-setup`: Azure configuration
- `azure-test-connection`: Azure connectivity testing
- `test-fast`: Quick unit tests

### Recommended Workflow
1. **Start**: Run "dev-start" task
2. **Develop**: Make changes with `dotnet watch` running
3. **Test**: Run "test-fast" task for quick feedback
4. **Clean**: Run "cleanup-dotnet" when done

## üîß Development Best Practices

### Python Script Usage
- **Always use Python scripts** over PowerShell equivalents
- **Test scripts** before committing changes
- **Use VS Code tasks** for consistent execution
- **Check script output** for proper error handling

### Environment Setup
- **Load environment first**: `python scripts/load-env.py`
- **Test connections**: `python scripts/load-env.py --test-connections`
- **Validate Azure setup**: `python scripts/azure-setup.py --test-connection`

### Testing Strategy
- **Run unit tests** before committing
- **Use coverage reports** to identify gaps
- **Test Azure features** with proper mocking
- **Parallel execution** for faster feedback

## üö´ Legacy PowerShell Scripts

**DO NOT USE** these archived PowerShell scripts:
- `dev-start.ps1` ‚Üí Use `dev-start.py`
- `load-env.ps1` ‚Üí Use `load-env.py`
- `cleanup-dotnet.ps1` ‚Üí Use `cleanup-dotnet.py`
- `setup-azure.ps1` ‚Üí Use `azure-setup.py`

All legacy scripts are archived in `scripts/deprecated-backup/` and are no longer maintained.

## üìä Benefits of Python Tooling

- **Cross-platform**: Works on Windows, macOS, Linux
- **Maintainable**: Clean, testable Python code
- **Integrated**: Seamless VS Code integration
- **Testable**: Comprehensive test framework with coverage
- **Secure**: Proper environment variable handling
- **Performant**: Optimized for development workflows

## üîÑ Migration from PowerShell

The Python scripts provide enhanced functionality:
- Additional validation and error handling
- Cross-platform compatibility
- Performance optimizations
- Comprehensive logging and monitoring
- Unit test coverage
- Better integration with modern development tools

## üÜò Troubleshooting

### Common Issues
- **Environment not loading**: Run `python scripts/load-env.py`
- **Azure connection failed**: Run `python scripts/azure-setup.py --test-connection`
- **Processes not cleaning**: Run `python scripts/cleanup-dotnet.py --force`
- **Tests failing**: Check `pytest.ini` configuration

### Getting Help
- Check `scripts/README.md` for detailed documentation
- Run scripts with `--help` flag for usage information
- Check VS Code task output for detailed error messages
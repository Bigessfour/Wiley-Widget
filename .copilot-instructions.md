# Wiley Widget Development Guidelines

## ÔøΩ Project Overview
Wiley Widget is a .NET WPF application focused on municipal budgeting and utility management. Key technologies include Syncfusion for UI components, Prism for modular architecture and view management, Entity Framework Core for data access, and Microsoft.Extensions.Hosting for dependency injection. We're in the process of refactoring to put Prism fully in control of startup, views, and navigation‚Äîditching custom hacks for cleaner, more maintainable code.

## üöÄ Core Development Workflow

### Startup and Build
- Use `dotnet build` for compilation.
- Run the app with `dotnet run` from the src/ directory.
- For watching changes: `dotnet watch run`.
- Clean builds: `dotnet clean`.

### Configuration
- Edit `appsettings.json` and `appsettings.Development.json` for environment-specific settings.
- Use `App.config` for legacy config needs.
- Avoid hardcoding paths‚Äîleverage relative paths and environment variables.

### Debugging
- Set breakpoints in VS Code or Visual Studio.
- Use the built-in debugger for WPF-specific issues (e.g., UI threading problems).
- Refer to `docs/DEBUGPY_STARTUP_GUIDE.md` for advanced startup debugging.

## üß™ Testing Framework

### Test Execution
- Unit tests: `dotnet test` from the root or test project directories.
- Integration tests: Focus on EF Core and Prism navigation‚Äîrun via `dotnet test --filter Category=Integration`.
- UI tests: Use FlaUI for automation in WileyWidget.UiTests.
- Aim for high coverage on ViewModels and services.

### Test Structure
- **Unit tests**: Isolate ViewModels, services, and utilities.
- **Integration tests**: Cover database migrations, Prism module init, and navigation flows.
- **UI tests**: Verify rendering and data binding for Syncfusion controls.

## üìã VS Code Integration

### Recommended Extensions
- C# (ms-dotnettools.csharp) for IntelliSense and debugging.
- NuGet Gallery for package management.
- WPF Tools for XAML preview (if available).
- GitLens for better version control insights.

### Available Tasks (in .vscode/tasks.json)
- `build`: Runs `dotnet build`.
- `test`: Runs `dotnet test`.
- `clean`: Runs `dotnet clean`.
- `watch`: Runs `dotnet watch run` for hot reload.

### Recommended Workflow
1. **Build**: Run "build" task.
2. **Develop**: Edit code with hot reload via "watch" task.
3. **Test**: Run "test" task for feedback.
4. **Commit**: Use GitLens to review changes.

## üîß Development Best Practices

### Code Standards
- Follow layered architecture: Separate concerns into Views, ViewModels, Models, Services.
- Use Prism for all view registration, navigation, and module management.
- Inject dependencies via constructor injection.
- Handle UI threading properly‚Äîdispatch to UI thread for updates.

### Prism Usage
- Bootstrapper handles startup: Inherit from PrismBootstrapper for shell creation and module config.
- Register views with regions in module Initialize().
- Use INavigationAware in ViewModels for parameterized navigation.
- Avoid custom navigation services‚Äîstick to Prism's RegionManager.

### Syncfusion Integration
- All UI components (e.g., SfDataGrid, SfChart) must be themed via ThemeUtility (see below).
- Test rendering in UI tests to catch binding issues.

### Contribution
- Follow `CONTRIBUTING.md` for PRs.
- Update `CHANGELOG.md` and `RELEASE_NOTES.md` with changes.
- Run tests before pushing.

## üé® Theme Management Guidelines

### ThemeUtility Implementation - SOLE AUTHORITY

**CRITICAL RULE**: `ThemeUtility` is the **exclusive** theme management system for Wiley Widget. **NO** direct `SfSkinManager` calls are permitted in application code.

#### ‚úÖ **Approved Theme Implementation**

**Only use these methods for theme application:**

```csharp
// ‚úÖ CORRECT - Use ThemeUtility exclusively
using WileyWidget.Services;

ThemeUtility.TryApplyTheme(window, "FluentDark");
ThemeUtility.TryApplyTheme(window, "FluentLight");
ThemeUtility.ApplyCurrentTheme(window);
// ‚ùå VIOLATION - Direct SfSkinManager calls
SfSkinManager.SetTheme(window, new Theme("FluentDark"));

// ‚ùå VIOLATION - Custom theme objects
var customTheme = new FluentTheme { /* custom properties */
<?xml version="1.0" encoding="utf-8"?>
<Project>
  <PropertyGroup>
    <!-- Force PlatformTarget to x64 for all projects unless explicitly overridden -->
    <PlatformTarget>x64</PlatformTarget>
    <!-- Disable preferring 32-bit so x64 is used on 64-bit machines -->
    <Prefer32Bit>false</Prefer32Bit>
    <!-- Optional: ensure consistent assembly name behavior when PlatformTarget changes -->
    <AppendPlatformToOutputPath>false</AppendPlatformToOutputPath>
  </PropertyGroup>

  <!--
    WileyWidget Build Configuration
    See docs/development-guide.md for comprehensive development standards
    See CONTRIBUTING.md for contribution guidelines
    See .vscode/project-plan.md for True North vision and roadmap
  -->
  <PropertyGroup>
    <!-- Fix MSB4184: Hardcode valid MSBuild version for .NET 9 analyzers -->
    <MSBuildVersionForAnalyzers>17.0</MSBuildVersionForAnalyzers>
    <AnalysisLevel>6.0</AnalysisLevel>
    <EnforceCodeStyleInBuild>false</EnforceCodeStyleInBuild>
    <TargetFramework>net9.0-windows10.0.19041.0</TargetFramework>
    <WindowsSdkPackageVersion>10.0.26100.81</WindowsSdkPackageVersion>
    <ManagePackageVersionsCentrally>false</ManagePackageVersionsCentrally>
    <UseWPF Condition="'$(MSBuildProjectName)' != 'WileyWidget.WinUI'">true</UseWPF>
    <WpfTmpProject Condition="'$(WpfTmpProject)' == ''">true</WpfTmpProject>
    <RuntimeIdentifier>win-x64</RuntimeIdentifier>
    <RestoreAdditionalProjectSources Condition="'$(RestoreAdditionalProjectSources)' == ''">https://api.nuget.org/v3/index.json</RestoreAdditionalProjectSources>
    <SelfContained>false</SelfContained>
    <Nullable>disable</Nullable>
    <RestoreAdditionalProjectFallbackFolders></RestoreAdditionalProjectFallbackFolders>
    <NoWarn>$(NoWarn);NU1605;NU1603;NETSDK1206;CS0436</NoWarn>
    <TreatWarningsAsErrors>false</TreatWarningsAsErrors>
    <RunAnalyzers>false</RunAnalyzers>
    <RunAnalyzersDuringBuild>false</RunAnalyzersDuringBuild>
    <RunAnalyzersDuringLiveAnalysis>false</RunAnalyzersDuringLiveAnalysis>
    <EnableNETAnalyzers>false</EnableNETAnalyzers>
    <EnableNETAnalyzers Condition="'$(EnableNETAnalyzers)' == ''">false</EnableNETAnalyzers>

    <!-- Aggressive build performance optimizations -->
    <UseSharedCompilation>true</UseSharedCompilation>
    <ProduceReferenceAssemblyInOutDir>true</ProduceReferenceAssemblyInOutDir>
    <AccelerateBuildsInVisualStudio>true</AccelerateBuildsInVisualStudio>
    <UseCommonOutputDirectory>false</UseCommonOutputDirectory>

    <DisableFastUpToDateCheck>false</DisableFastUpToDateCheck>
    <DisableImplicitFrameworkReferences>false</DisableImplicitFrameworkReferences>
    <EnableDefaultCompileItems>true</EnableDefaultCompileItems>

    <BuildInParallel>true</BuildInParallel>
    <MaxCpuCount>0</MaxCpuCount>
    <ContinueOnError>false</ContinueOnError>

    <RestoreUseStaticGraphEvaluation>true</RestoreUseStaticGraphEvaluation>
    <RestorePackagesWithLockFile>true</RestorePackagesWithLockFile>
    <RestoreLockedMode Condition="'$(Configuration)' == 'Release' AND Exists('$(MSBuildProjectDirectory)\packages.lock.json')">true</RestoreLockedMode>
    <CopyLocalLockFileAssemblies>true</CopyLocalLockFileAssemblies>

    <RunAnalyzers Condition="'$(Configuration)' == 'Debug'">false</RunAnalyzers>
    <RunAnalyzersDuringBuild Condition="'$(Configuration)' == 'Debug'">false</RunAnalyzersDuringBuild>
    <RunAnalyzersDuringLiveAnalysis Condition="'$(Configuration)' == 'Debug'">false</RunAnalyzersDuringLiveAnalysis>
    <EnableNETAnalyzers Condition="'$(Configuration)' == 'Debug'">false</EnableNETAnalyzers>

    <GenerateDocumentationFile Condition="'$(Configuration)' == 'Debug'">false</GenerateDocumentationFile>
    <DebugType Condition="'$(Configuration)' == 'Debug'">embedded</DebugType>
    <DebugSymbols Condition="'$(Configuration)' == 'Debug'">true</DebugSymbols>
    <Optimize Condition="'$(Configuration)' == 'Debug'">false</Optimize>

    <Deterministic>true</Deterministic>
    <ContinuousIntegrationBuild Condition="'$(CI)' == 'true'">true</ContinuousIntegrationBuild>

    <GenerateAssemblyInfo>true</GenerateAssemblyInfo>
    <GenerateTargetFrameworkAttribute>false</GenerateTargetFrameworkAttribute>

    <DefaultItemExcludes>$(DefaultItemExcludes);**\bin\**;**\obj\**;**\node_modules\**;**\.vs\**;**\.vscode\**</DefaultItemExcludes>

    <GenerateTemporaryTargetAssembly>false</GenerateTemporaryTargetAssembly>
    <AlwaysCompileMarkupFilesInSeparateDomain>false</AlwaysCompileMarkupFilesInSeparateDomain>
    <IncludePackageReferencesDuringMarkupCompilation>true</IncludePackageReferencesDuringMarkupCompilation>
    <!-- Disable XAML-generated Debugger.Break across the solution to avoid auto-breaks on unhandled exceptions during debugger attach -->
    <DefineConstants>$(DefineConstants);DISABLE_XAML_GENERATED_BREAK_ON_UNHANDLED_EXCEPTION</DefineConstants>

    <!-- XAML Compilation Settings: Enable for WinUI, disable for WPF to preserve performance -->
    <XamlDebuggingInformation Condition="'$(Configuration)' == 'Debug' AND '$(MSBuildProjectName)' != 'WileyWidget.WinUI'">false</XamlDebuggingInformation>
    <XamlDebuggingInformation Condition="'$(MSBuildProjectName)' == 'WileyWidget.WinUI'">true</XamlDebuggingInformation>
    <EnableMsixTooling>false</EnableMsixTooling>
    <GenerateAppxPackageOnBuild>false</GenerateAppxPackageOnBuild>
    <AppxPackage>false</AppxPackage>
    <SkipPriGeneration>true</SkipPriGeneration>
    <WindowsPackageType>None</WindowsPackageType>
    <WindowsAppContainer>false</WindowsAppContainer>
    <!-- Fix MSB4062: Point to Visual Studio 2022 Professional MSIX tools -->
    <AppxMSBuildToolsPath>C:\Program Files\Microsoft Visual Studio\2022\Professional\MSBuild\Microsoft\VisualStudio\v17.0\AppxPackage\</AppxMSBuildToolsPath>
  </PropertyGroup>

  <Target Name="RunAnalyzers" />

</Project>

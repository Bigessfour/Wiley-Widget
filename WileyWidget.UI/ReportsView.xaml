<?xml version="1.0" encoding="UTF-8" ?>
<UserControl x:Class="WileyWidget.ReportsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:behaviors="clr-namespace:WileyWidget.UI.Behaviors"
             xmlns:syncfusion="http://schemas.syncfusion.com/wpf"
             xmlns:pdf="clr-namespace:Syncfusion.Windows.PdfViewer;assembly=Syncfusion.PdfViewer.WPF"
             xmlns:syncfusionskin="clr-namespace:Syncfusion.SfSkinManager;assembly=Syncfusion.SfSkinManager.WPF"
             xmlns:darkTheme="clr-namespace:Syncfusion.Themes.FluentDark.WPF;assembly=Syncfusion.Themes.FluentDark.WPF"
             xmlns:prism="http://prismlibrary.com/"
             mc:Ignorable="d"
             prism:ViewModelLocator.AutoWireViewModel="True"
             Height="800"
             Width="1200"
             FontFamily="Segoe UI">
    <darkTheme:SfAcrylicPanel TintBrush="#202020"
                              TintOpacity="0.25"
                              BlurRadius="30"
                              NoiseOpacity="0.03">
        <Grid Background="#FF0F1724"
              behaviors:FocusOnLoadBehavior.IsEnabled="True"
              behaviors:FocusOnLoadBehavior.TargetName="ReportsFocusAnchor"
              behaviors:MouseFocusBehavior.EnableOnClick="True"
              behaviors:MouseFocusBehavior.EnableOnFirstMove="True">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <Border x:Name="ReportsFocusAnchor"
                    Focusable="True"
                    Width="0"
                    Height="0"
                    Opacity="0" />
            <Border Grid.Row="0"
                    Margin="16"
                    Padding="16"
                    Background="#661C283A"
                    CornerRadius="12">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="16" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="16" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="16" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="12" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <StackPanel Orientation="Vertical">
                        <TextBlock Text="Start Date"
                                   Foreground="#FFE1F2FF"
                                   FontWeight="SemiBold" />
                        <syncfusion:SfDatePicker Value="{Binding StartDate, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                 SetValueOnLostFocus="True"
                                                 Width="180" />
                    </StackPanel>
                    <StackPanel Grid.Column="2"
                                Orientation="Vertical">
                        <TextBlock Text="End Date"
                                   Foreground="#FFE1F2FF"
                                   FontWeight="SemiBold" />
                        <syncfusion:SfDatePicker Value="{Binding EndDate, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                 SetValueOnLostFocus="True"
                                                 Width="180" />
                    </StackPanel>
                    <StackPanel Grid.Column="4"
                                Orientation="Vertical">
                        <TextBlock Text="Enterprise"
                                   Foreground="#FFE1F2FF"
                                   FontWeight="SemiBold" />
                        <syncfusion:ComboBoxAdv ItemsSource="{Binding Enterprises}"
                                                DisplayMemberPath="Name"
                                                SelectedValuePath="Id"
                                                SelectedValue="{Binding EnterpriseId, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                Width="220"
                                                IsEditable="False" />
                    </StackPanel>
                    <StackPanel Grid.Column="6"
                                Orientation="Vertical">
                        <TextBlock Text="Filter"
                                   Foreground="#FFE1F2FF"
                                   FontWeight="SemiBold" />
                        <TextBox Text="{Binding Filter, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                 Width="220"
                                 Margin="0,2,0,0" />
                    </StackPanel>
                    <StackPanel Grid.Column="8"
                                Orientation="Horizontal"
                                VerticalAlignment="Bottom">
                        <Button Content="Generate"
                                Command="{Binding GenerateReportCommand}"
                                Width="120"
                                Height="36"
                                ToolTip="Generate: Unleash the reports!"
                                Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}" />
                        <Button Content="Export PDF"
                                Command="{Binding ExportCommand}"
                                CommandParameter="pdf"
                                Width="110"
                                Height="36" />
                        <Button Content="Export Excel"
                                Command="{Binding ExportCommand}"
                                CommandParameter="excel"
                                Width="110"
                                Height="36" />
                    </StackPanel>
                    <StackPanel Grid.Column="10"
                                VerticalAlignment="Bottom"
                                Orientation="Horizontal">
                        <ProgressBar Width="140"
                                     Height="14"
                                     Minimum="0"
                                     Maximum="100"
                                     Value="{Binding ProgressPercentage}" />
                        <TextBlock Text="{Binding StatusMessage}"
                                   Foreground="#FFB6C8DE"
                                   FontSize="11" />
                    </StackPanel>
                </Grid>
            </Border>
            <TabControl Grid.Row="1"
                        Margin="16"
                        SelectedIndex="0">
                <TabItem Header="Report Viewer">
                    <Grid Background="#FF122034">
                        <!-- Bold Reports WPF Report Viewer - currently not available in installed package
                             TODO: Install correct Bold Reports WPF Report Viewer package when available
                             For now, showing fallback message -->
                        <TextBlock x:Name="FallbackText"
                                   Text="Bold Reports WPF Report Viewer not available. Please install the correct Bold Reports WPF package and configure licensing. See README for setup instructions."
                                   Margin="16"
                                   Foreground="White"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Center"
                                   TextWrapping="Wrap"
                                   Visibility="Visible" />
                    </Grid>
                </TabItem>
                <TabItem Header="Tabular Data">
                    <Grid Background="#FF122034">
                        <syncfusion:SfDataGrid ItemsSource="{Binding ReportItems}"
                                               Margin="16"
                                               AutoGenerateColumns="True"
                                               AllowSorting="True"
                                               AllowFiltering="True"
                                               ShowGroupDropArea="True"
                                               ColumnSizer="AutoWithLastColumnFill" />
                    </Grid>
                </TabItem>
            </TabControl>
        </Grid>
    </darkTheme:SfAcrylicPanel>
</UserControl>
